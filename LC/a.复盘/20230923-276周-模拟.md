### T4 [2141. 同时运行 N 台电脑的最长时间](https://leetcode.cn/problems/maximum-running-time-of-n-computers/)

##### 1 emphasis



##### 2 key points

你有 `n` 台电脑。给你整数 `n` 和一个下标从 **0** 开始的整数数组 `batteries` ，其中第 `i` 个电池可以让一台电脑 **运行** `batteries[i]` 分钟。你想使用这些电池让 **全部** `n` 台电脑 **同时** 运行。

一开始，你可以给每台电脑连接 **至多一个电池** 。然后在任意整数时刻，你都可以将一台电脑与它的电池断开连接，并连接另一个电池，你可以进行这个操作 **任意次** 。新连接的电池可以是一个全新的电池，也可以是别的电脑用过的电池。断开连接和连接新的电池不会花费任何时间。

注意，你不能给电池充电。

请你返回你可以让 `n` 台电脑同时运行的 **最长** 分钟数。



##### 3 thought



##### 4 code

```cpp
class Solution {
public:
    using ll = long long;
    long long maxRunTime(int n, vector<int>& bs) {
        int m = bs.size();
        ll sum = 0;
        for (auto& e : bs) {
            sum += e;
        }
        
        auto check = [&](ll mid) -> bool {
            ll s = 0;
            for (auto& e : bs) {
                s += min((ll)e, mid);
            }
            return s >= mid * n;
        };
        
        ll ans = 0;
        ll l = 0, r = sum;
        while (l <= r ) {
            ll mid = (l + r) >> 1;
            if (check(mid)) {
                ans = mid;
                l = mid + 1;
            } else {
                r = mid - 1;
            }
        }
        return ans;
    }
};
```



##### 5 summary

###### 5.1 思考

对于n台电脑和m个充电器，m>=n，每个充电器具有其充电时间，充电器同一时间只能给一个电脑充电，问能给n台电脑充电的最长时间

此类题目比较抽象，思维难度较高。

* 假设给n台电脑的最大充电时间是k，那么对于那些电能大于k的充电器，大于k的那部分电能其实根本用不到，所以可以将所有电能大于k的充电器的电能设置成k即可。此时，所有充电器的电能均不大于k。

* **对于电能均不大于k的m个充电器，在其电能总和大于等于n * k的前提下，可以满足给n台电脑充电k时间**

  * 假设 m == n，此时必须所有的电池电能都是k，即sum(m) == n * k，很好理解

  * 假设m > n，若此时sum(m) >= n * k，怎么证明能满足n台电脑充电k时间

    ```CPP
    // 将k天想象成k个队列，每个队列的长度是n，表示每1天需要完成n台电脑，总共k天
    // 依次对每个队列进行填充(充电)，即使用电池平铺，直到填充满所有队列为止，不难发现，这种填充方法是合法的，即为解
    
    // n = 4, k = 3 
    // 假设 电池数组为 [1,1,2,3,3,3]，电脑分别为[a,b,c,d]
    //   /   | 队列1（第1天）| 队列2（第2天）| 队列3（第3天）
    //   a   |  0      |      1      |      2
    //   b   |  2      |      3      |      3
    //   c   |  3      |      4      |      4
    //   d   |  4      |      5      |      5
    //       |  5（多余）
    
    // 核心原理：
    // 由于所有电池的电能<=k，即列数col，所以不存在某一个电池在每天充一次后还有剩余，
    // 即没有电池能跨行，从而保证方案的正确性
    
    
    // 把电脑想象一个队列是否可行？不可行！
    // 明显，虽然不能按照电脑去依次平摊，但是可以按照天数去平摊，只要找到一种可行解即可
    // 可以画一个二维表格出来
    ```

    | 电脑\天数 | 1    | 2    | 3    |
    | --------- | ---- | ---- | ---- |
    | 1         | 0    | 1    | 2    |
    | 2         | 2    | 3    | 3    |
    | 3         | 3    | 4    | 4    |
    | 4         | 4    | 5    | 5    |
    | 5         | 5    |      |      |

    

    







