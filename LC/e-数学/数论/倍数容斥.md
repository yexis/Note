### Title 倍数容斥

##### 1 emphasis

- 倍数容斥

- 计算有多少个**子序列 | 数对**的 $GCD$ 恰好等于 $i$

  

##### 2 key points

令$gcd\_cnt_i$表示最大公约数$gcd$等于$i$的子序列个数

很明显，对于任一$gcd$等于$i$的序列来说，序列中的所有元素必是$i$的倍数，即$(i...,2i...,...,3i...,ki...)$；



那么，可以先寻找出数组中所有$i$的倍数，然后判断这些元素（假设有$n$个）能组成多少个子序列

但是，这些元素所组成的子序列的$gcd$并不一定是$i$，而一定只是$i$的倍数

所以，需要将最大公约数不等于$i$的子序列进行排除

$gcd\_cnt_i = (2^n - 1) - gcd\_cnt_{2i} - \ gcd\_cnt_{3i} - ... - gcd\_cnt_{ki}$



所以，整体上需要倒序遍历，先将 计算$gcd = k*i$的答案，再计算$gcd = (k - 1)*i$的答案，以此类推，最后计算$gcd = i$的答案

```cpp
假设题干为求子序列
1. 先计算满足条件 gcd = ki 的子序列数量，设为 f[ki]
2. 再计算 gcd = (k - 1)i 的子序列数量，设为f[(k-1)i]（依赖 f[ki]）
3. ...
4. 最后计算 gcd = i 的子序列数量，设为 f[i]（依赖f[2i],f[3i],...,f[ki]）
```



##### 3 thought



##### 4 code



##### 5 summary

