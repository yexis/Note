### Title 特殊子字符串

##### 1 emphasis

- 特殊子字符串
- 相同字符集中某个区间



##### 2 key points

 **特殊子字符串** 是满足以下条件的子字符串：

- 子字符串中的任何字符都不应该出现在字符串其余部分中。
- 子字符串不能是整个字符串 `s`。

特殊子字符串



##### 3 thought

对一个仅包含小写字母的字符串$s$，计算其中所有的**特殊子字符串**



对于一个字符首次出现的位置和最后出现的位置分别使用$l$和$r$表示

1. 首先，满足题目条件的【最小】特殊子字符串个数一定不超过$26$个，【最小】即不能再小；
    - 强调最小是因为两个特殊子字符串可能是连续的，比如 `acacbdbd` 字符串中有$3$个特殊子字符串；

2. 每个特殊子字符串必定以某个字符开始(但是不一定以该字符结束，如`acacbdbd`)，那么统计以$26$个字符开始的特殊子字符串即可；

3. 对于任意的两个字符$c_1,c_2$，由他们形成的特殊子字符串一定是不相交的，即不可能出现 $l_1 ... l_2 ... r_1 ... r_2$，这违背了题意；
    - 所以只可能是 $l_1 ... l_2 ... r_2 ... l_1$，或者 $l_1 ... r_1 ... l_2 ... r_2$

4. 那么，如何统计这些特殊子字符串呢？
    - 很明显，特殊子字符串的起始位置一定是一个字符的首次出现的位置
    - 那么对于某个字符首次出现的位置，一定能找到一个特殊子字符串吗？答案是不一定，因为如果$[l,..c_2..,r]$假如中间出现了$c_2$，且$c_2$的首次出现位置在$l$之前，那么从$l$出发就找不到特殊子字符串
    - 所以，从每个起始位置开始，看能否找到特殊子字符串，每遍历到一个字符$c$，更新`mx=max(mx, r_c)`，直到遍历到`mx`没再出现新字符，说明找到了一个特殊子字符串



所以，特殊子字符串具有一下性质：

1. 字符串`s`中的特殊子字符串数量不超过`s`中不同字符的个数

2. `s`中所有的最小特殊子字符串（不可再分）均以不同的字符开头

3. 对于任意字符$c$，以$c$开头的特殊子字符串数量不会超过$1$

4. 以字符$c$开头的特殊子字符串不一定以字符$c$结束，例如`acacbdbd`

    1. 对于字符串`acacbdbd`，特殊子字符串有`acacbdbd`，`acac`，`bdbd`
    2. 对于字符串`acacbdbd`，最小特殊子字符串有`acac`，`bdbd`

    

##### 4 code

```cpp
vector<int> cal(string& s) {
    int n = s.size();
    vector<set<int>> st(26);
    for (int i = 0; i < n; i++) {
        st[s[i] - 'a'].insert(i);
    }

    // per[i]表示满足以i结尾的特殊子字符串的最大左边界，
    // 即最小特殊子字符串的左边界
    vector<int> per(n, -1);

    // 遍历每个字符
    for (int d = 0; d < 26; d++) {
        if (st[d].size() == 0) continue;
        int be = *st[d].begin(), en = *st[d].rbegin();
        // 当前有边界，根据字符的进入进行扩展
        int mx = en;
        for (int i = be; i < n; i++) {
            int dd = s[i] - 'a';
            int be1 = *st[dd].begin(), en1 = *st[dd].rbegin();
            mx = max(mx, en1);
            // 这一行很关键，如果be1 < be，说明[be,en]区间中出现的字符在be前就出现过
            // 那么be不可能成为特殊子字符串的开头了
            if (be1 < be) break;
            // 说明已经走到mx了，当前区间就是特殊子字符串
            if (i == mx) {
                per[i] = be;
                break;
            }
        }
    }
    return per;
}
```



##### 5 summary

